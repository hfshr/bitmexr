<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bucket trade data over an extended period — map_bucket_trades • bitmexr</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Bucket trade data over an extended period — map_bucket_trades" />
<meta property="og:description" content="map_bucket_trades() uses purrr::map_dfr to execute multiple API calls.
This is useful when the data you want to return exceeds the maximum 1000 row response limit,
but do not want to have to manually call bucket_trades() repeatedly." />


<meta name="robots" content="noindex">

<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-145834792-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-145834792-2');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">bitmexr</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/getting-started.html">Intro</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/authentication.html">Authentication</a>
    </li>
    <li>
      <a href="../articles/trade-data.html">Trade data</a>
    </li>
    <li>
      <a href="../articles/placing-orders.html">Placing orders with bitmexr</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/hfshr/bitmexr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bucket trade data over an extended period</h1>
    <small class="dont-index">Source: <a href='https://github.com/hfshr/bitmexr/blob/master/R/map_bucket_trades.R'><code>R/map_bucket_trades.R</code></a></small>
    <div class="hidden name"><code>map_bucket_trades.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>map_bucket_trades()</code> uses <code><a href='https://purrr.tidyverse.org/reference/map.html'>purrr::map_dfr</a></code> to execute multiple API calls.
This is useful when the data you want to return exceeds the maximum 1000 row response limit,
but do not want to have to manually call <code><a href='bucket_trades.html'>bucket_trades()</a></code> repeatedly.</p>
    </div>

    <pre class="usage"><span class='fu'>map_bucket_trades</span>(
  <span class='kw'>start_date</span> <span class='kw'>=</span> <span class='st'>"2015-09-25 13:00:00"</span>,
  <span class='kw'>end_date</span> <span class='kw'>=</span> <span class='fu'>now</span>(<span class='kw'>tzone</span> <span class='kw'>=</span> <span class='st'>"UTC"</span>),
  <span class='kw'>binSize</span> <span class='kw'>=</span> <span class='st'>"1d"</span>,
  <span class='kw'>symbol</span> <span class='kw'>=</span> <span class='st'>"XBTUSD"</span>,
  <span class='kw'>partial</span> <span class='kw'>=</span> <span class='st'>"false"</span>,
  <span class='kw'>filter</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>use_auth</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>start_date</th>
      <td><p>character string.
Starting date for results in the format <code>"yyyy-mm-dd"</code> or <code>"yyyy-mm-dd hh-mm-ss"</code>.</p></td>
    </tr>
    <tr>
      <th>end_date</th>
      <td><p>character string.
Ending date for results in the format <code>"yyyy-mm-dd"</code> or <code>"yyyy-mm-dd hh-mm-ss"</code>.</p></td>
    </tr>
    <tr>
      <th>binSize</th>
      <td><p>character string.
The time interval to bucket by, must be one of: <code>"1m"</code>, <code>"5m"</code>, <code>"1h"</code> or <code>"1d"</code>.</p></td>
    </tr>
    <tr>
      <th>symbol</th>
      <td><p>a character string for the instrument symbol.
Use <code><a href='available_symbols.html'>available_symbols()</a></code> to see available symbols.</p></td>
    </tr>
    <tr>
      <th>partial</th>
      <td><p>character string. Either <code>"true"</code> or <code>"false"</code>.
If <code>"true"</code>, will send in-progress (incomplete) bins for the current time period.</p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p>an optional character string for table filtering.
Send JSON key/value pairs, such as <code>"{'key':'value'}"</code>. See examples in <code><a href='trades.html'>trades()</a></code>.</p></td>
    </tr>
    <tr>
      <th>use_auth</th>
      <td><p>logical. Use <code>TRUE</code> to enable authentication with API key.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>logical. If <code>TRUE</code>, will print information to the console. Useful for
long running requests.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>map_bucket_trades</code> returns a <code>data.frame</code> containing:</p><ul>
<li><p>timestamp: POSIXct. Date and time of trade.</p></li>
<li><p>symbol: character. Instrument ticker.</p></li>
<li><p>open: numeric. Opening price for the bucket.</p></li>
<li><p>high: numeric. Highest price in the bucket.</p></li>
<li><p>low: numeric. Lowest price in the bucket.</p></li>
<li><p>close: numeric. Closing price of the bucket.</p></li>
<li><p>trades: numeric. Number of trades executed within the bucket.</p></li>
<li><p>volume: numeric. Volume in USD.</p></li>
<li><p>vwap: numeric. Volume weighted average price.</p></li>
<li><p>lastSize: numeric. Size of the last trade executed.</p></li>
<li><p>turnover: numeric. How many satoshi were exchanged.</p></li>
<li><p>homeNotional: numeric. BTC value of the bucket.</p></li>
<li><p>foreignNotional: numeric. USD value of the bucket.</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>map_bucket_trades()</code> takes a start and end date, and creates a sequence of start dates
which are passed in to the `startTime`` parameter in <code><a href='bucket_trades.html'>bucket_trades()</a></code>.</p>
<p>The length of time between each start time in each API call is determined by the binSize.
For example, <code>"1d"</code> is chosen as the binSize the length of time between start dates will be 1000 days.
If <code>"1h"</code> is chosen, it will be 1000 hours etc.</p>
<p>The function will print the number of API calls being sent and provides a progress bar in the console</p>
<p>Public API requests are limited to 30 per minute. Consequently, <code>map_bucket_trades()</code> uses
<code><a href='https://purrr.tidyverse.org/reference/insistently.html'>purrr::slowly</a></code> to restrict how often the function is called.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p><a href='https://www.bitmex.com/api/explorer/#!/Trade/Trade_getBucketed'>https://www.bitmex.com/api/explorer/#!/Trade/Trade_getBucketed</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># Get hourly bucketed trade data between 2020-01-01 and 2020-02-01</span>

<span class='fu'>map_bucket_trades</span>(
  <span class='kw'>start_date</span> <span class='kw'>=</span> <span class='st'>"2020-01-01"</span>,
  <span class='kw'>end_date</span> <span class='kw'>=</span> <span class='st'>"2020-02-01"</span>,
  <span class='kw'>binSize</span> <span class='kw'>=</span> <span class='st'>"1h"</span>
)
}</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://hfshr.netlify.app/'>Harry Fisher</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


